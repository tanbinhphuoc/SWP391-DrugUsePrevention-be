2025-07-24 13:58:24.940 +07:00 [INF] Updated ReturnUrl to: https://099cbc740dbf.ngrok-free.app/api/vnpay/return
2025-07-24 13:58:25.977 +07:00 [INF] Start installing Hangfire SQL objects...
2025-07-24 13:58:27.185 +07:00 [INF] Hangfire SQL objects installed.
2025-07-24 13:58:28.242 +07:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'CourseRegistration'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-07-24 13:58:29.573 +07:00 [INF] Starting Hangfire Server using job storage: 'SQL Server: LAPTOP-QLC4GKI0\SQLEXPRESS@DrugUsePreventionDB_V4'
2025-07-24 13:58:29.575 +07:00 [INF] Using the following options for SQL Server job storage: Queue poll interval: 00:00:00.
2025-07-24 13:58:29.576 +07:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-24 13:58:29.666 +07:00 [INF] Server laptop-qlc4gki0:22088:24d3bd96 successfully announced in 61.3463 ms
2025-07-24 13:58:29.707 +07:00 [INF] Server laptop-qlc4gki0:22088:24d3bd96 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, SqlServerHeartbeatProcess, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-24 13:58:29.818 +07:00 [INF] Server laptop-qlc4gki0:22088:24d3bd96 all the dispatchers started
2025-07-24 13:58:29.984 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:602292aa-00e6-47ad-9823-3a6c7a99e2c5
Error Number:8622,State:1,Class:16
2025-07-24 13:58:30.029 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:3e767921-364a-4ea6-b36b-38209231ab51
Error Number:8622,State:1,Class:16
2025-07-24 13:58:30.041 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:3e767921-364a-4ea6-b36b-38209231ab51
Error Number:8622,State:1,Class:16
2025-07-24 13:58:30.053 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:3e767921-364a-4ea6-b36b-38209231ab51
Error Number:8622,State:1,Class:16
2025-07-24 13:59:15.153 +07:00 [WRN] Failed to determine the https port for redirect.
2025-07-24 13:59:15.883 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753339584, exp: 1753425984, iat: 1753339584, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 13:59:16.621 +07:00 [INF] Retrieving available consultants
2025-07-24 13:59:17.152 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 13:59:17.294 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753339584, exp: 1753425984, iat: 1753339584, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 13:59:17.327 +07:00 [INF] Retrieving available consultants
2025-07-24 13:59:17.364 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:01:15.877 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:01:15.901 +07:00 [INF] Retrieving available consultants
2025-07-24 14:01:16.029 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:01:16.034 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:01:16.038 +07:00 [INF] Retrieving available consultants
2025-07-24 14:01:16.045 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:02:02.981 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:02:03.033 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:04:20.840 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:04:20.917 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:04:20.938 +07:00 [INF] Retrieving all users
2025-07-24 14:04:21.006 +07:00 [INF] Retrieved 25 users
2025-07-24 14:04:21.026 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:04:21.031 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:04:21.035 +07:00 [INF] Retrieving all users
2025-07-24 14:04:21.041 +07:00 [INF] Retrieved 25 users
2025-07-24 14:04:21.169 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:04:21.172 +07:00 [INF] Retrieving available consultants
2025-07-24 14:04:21.426 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:04:21.430 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:04:21.435 +07:00 [INF] Retrieving available consultants
2025-07-24 14:04:21.450 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:07:55.895 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:07:56.295 +07:00 [INF] Retrieving available consultants
2025-07-24 14:07:56.697 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:08:05.035 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:08:05.042 +07:00 [INF] Retrieving available consultants
2025-07-24 14:08:05.070 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:08:05.110 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:08:05.115 +07:00 [INF] Retrieving available consultants
2025-07-24 14:08:05.131 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:08:56.977 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:08:57.008 +07:00 [INF] Retrieving available consultants
2025-07-24 14:08:57.065 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:08:57.072 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:08:57.077 +07:00 [INF] Retrieving available consultants
2025-07-24 14:08:57.099 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:10:39.746 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:10:39.799 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:10:47.640 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:10:47.647 +07:00 [INF] Retrieving available consultants
2025-07-24 14:10:47.665 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:10:47.670 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:10:47.673 +07:00 [INF] Retrieving available consultants
2025-07-24 14:10:47.687 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:11:20.320 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:11:20.331 +07:00 [INF] Retrieving available consultants
2025-07-24 14:11:20.355 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:11:20.362 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:11:20.369 +07:00 [INF] Retrieving available consultants
2025-07-24 14:11:20.389 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:12:23.178 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:12:23.193 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:12:35.532 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:12:35.539 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:21:39.822 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:21:40.077 +07:00 [INF] Retrieving available consultants
2025-07-24 14:21:40.644 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:21:47.766 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:21:47.789 +07:00 [INF] Retrieving available consultants
2025-07-24 14:21:47.834 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:21:47.840 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:21:47.847 +07:00 [INF] Retrieving available consultants
2025-07-24 14:21:47.860 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:22:56.009 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:22:56.127 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:24:08.791 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:24:08.812 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:24:08.858 +07:00 [WRN] Username KingKAKA already exists
2025-07-24 14:24:09.480 +07:00 [WRN] Duplicate entity: User with Username 'KingKAKA' already exists.
DrugUsePreventionAPI.Exceptions.DuplicateEntityException: User with Username 'KingKAKA' already exists.
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantAsync(Int32 id, AdminUpdateConsultantDto updateConsultantDto) in C:\SWP391\DrugUsePreventionAPI\DrugUsePreventionAPI\Services\Implementations\ConsultantService .cs:line 130
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateConsultant(Int32 id, AdminUpdateConsultantDto updateConsultantDto) in C:\SWP391\DrugUsePreventionAPI\DrugUsePreventionAPI\Controllers\ConsultantController.cs:line 70
2025-07-24 14:24:27.610 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:24:27.628 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:25:17.002 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:25:17.022 +07:00 [INF] Retrieving available consultants
2025-07-24 14:25:17.105 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:25:17.111 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:25:17.122 +07:00 [INF] Retrieving available consultants
2025-07-24 14:25:17.130 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:28:30.202 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:460b3add-4d5d-46cd-b4ad-38e3a47b85ce
Error Number:8622,State:1,Class:16
2025-07-24 14:28:30.293 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:460b3add-4d5d-46cd-b4ad-38e3a47b85ce
Error Number:8622,State:1,Class:16
2025-07-24 14:28:30.315 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:460b3add-4d5d-46cd-b4ad-38e3a47b85ce
Error Number:8622,State:1,Class:16
2025-07-24 14:28:30.332 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:460b3add-4d5d-46cd-b4ad-38e3a47b85ce
Error Number:8622,State:1,Class:16
2025-07-24 14:39:42.341 +07:00 [INF] Updated ReturnUrl to: https://099cbc740dbf.ngrok-free.app/api/vnpay/return
2025-07-24 14:39:43.274 +07:00 [INF] Start installing Hangfire SQL objects...
2025-07-24 14:39:45.883 +07:00 [INF] Hangfire SQL objects installed.
2025-07-24 14:39:46.710 +07:00 [WRN] No store type was specified for the decimal property 'Amount' on entity type 'CourseRegistration'. This will cause values to be silently truncated if they do not fit in the default precision and scale. Explicitly specify the SQL server column type that can accommodate all the values in 'OnModelCreating' using 'HasColumnType', specify precision and scale using 'HasPrecision', or configure a value converter using 'HasConversion'.
2025-07-24 14:39:47.963 +07:00 [INF] Starting Hangfire Server using job storage: 'SQL Server: LAPTOP-QLC4GKI0\SQLEXPRESS@DrugUsePreventionDB_V4'
2025-07-24 14:39:47.965 +07:00 [INF] Using the following options for SQL Server job storage: Queue poll interval: 00:00:00.
2025-07-24 14:39:47.968 +07:00 [INF] Using the following options for Hangfire Server:
    Worker count: 20
    Listening queues: 'default'
    Shutdown timeout: 00:00:15
    Schedule polling interval: 00:00:15
2025-07-24 14:39:48.033 +07:00 [INF] Server laptop-qlc4gki0:37236:a7a71320 successfully announced in 32.0128 ms
2025-07-24 14:39:48.040 +07:00 [INF] Server laptop-qlc4gki0:37236:a7a71320 is starting the registered dispatchers: ServerWatchdog, ServerJobCancellationWatcher, ExpirationManager, CountersAggregator, SqlServerHeartbeatProcess, Worker, DelayedJobScheduler, RecurringJobScheduler...
2025-07-24 14:39:48.070 +07:00 [INF] 1 servers were removed due to timeout
2025-07-24 14:39:48.155 +07:00 [INF] Server laptop-qlc4gki0:37236:a7a71320 all the dispatchers started
2025-07-24 14:39:48.168 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:6889e90e-566a-4eae-9057-00387fe28a84
Error Number:8622,State:1,Class:16
2025-07-24 14:39:48.253 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:bb18a134-3071-46cf-9916-c29859e696a2
Error Number:8622,State:1,Class:16
2025-07-24 14:39:48.265 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:bb18a134-3071-46cf-9916-c29859e696a2
Error Number:8622,State:1,Class:16
2025-07-24 14:39:48.280 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.InternalExecuteNonQuery(TaskCompletionSource`1 completion, Boolean sendToPipe, Int32 timeout, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String methodName)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.<>c__DisplayClass39_0.<UseConnection>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 245
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:bb18a134-3071-46cf-9916-c29859e696a2
Error Number:8622,State:1,Class:16
2025-07-24 14:40:07.903 +07:00 [WRN] Failed to determine the https port for redirect.
2025-07-24 14:40:08.594 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:09.170 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:09.502 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:09.575 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:09.597 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:09.638 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:33.738 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:33.764 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:33.788 +07:00 [INF] Retrieving all users
2025-07-24 14:40:33.912 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:33.919 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:33.924 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:33.928 +07:00 [INF] Retrieving all users
2025-07-24 14:40:33.935 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:34.868 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:34.883 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:34.903 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:34.916 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:34.928 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:34.938 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:35.741 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:35.746 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:35.749 +07:00 [INF] Retrieving all users
2025-07-24 14:40:35.756 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:35.761 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:35.765 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:35.767 +07:00 [INF] Retrieving all users
2025-07-24 14:40:35.774 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:38.195 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:38.199 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:38.224 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:38.230 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:38.235 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:38.254 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:40.901 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:40.913 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:40.917 +07:00 [INF] Retrieving all users
2025-07-24 14:40:40.948 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:40.955 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:40.961 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 14:40:40.965 +07:00 [INF] Retrieving all users
2025-07-24 14:40:40.973 +07:00 [INF] Retrieved 25 users
2025-07-24 14:40:46.101 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:46.107 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:46.125 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:40:46.131 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:40:46.152 +07:00 [INF] Retrieving available consultants
2025-07-24 14:40:46.175 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:47:32.642 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:47:32.886 +07:00 [INF] Retrieving available consultants
2025-07-24 14:47:33.253 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:47:33.321 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:47:33.336 +07:00 [INF] Retrieving available consultants
2025-07-24 14:47:33.389 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:49:36.528 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:49:36.573 +07:00 [INF] Retrieving available consultants
2025-07-24 14:49:36.684 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:49:36.697 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:49:36.701 +07:00 [INF] Retrieving available consultants
2025-07-24 14:49:36.709 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:50:06.134 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:50:06.350 +07:00 [INF] Admin updating consultant with ID 8
2025-07-24 14:51:16.729 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:51:16.741 +07:00 [INF] Retrieving available consultants
2025-07-24 14:51:16.796 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 14:51:16.803 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 14:51:16.808 +07:00 [INF] Retrieving available consultants
2025-07-24 14:51:16.825 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:01:51.611 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:01:51.702 +07:00 [INF] Retrieving available consultants
2025-07-24 15:01:51.894 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:01:51.915 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753340472, exp: 1753426872, iat: 1753340472, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:01:51.925 +07:00 [INF] Retrieving available consultants
2025-07-24 15:01:51.968 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:03:23.021 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:03:23.078 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:03:23.303 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:03:23.334 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:03:23.351 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:03:23.367 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:03:24.069 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:03:24.140 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:07:53.018 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:07:53.565 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:07:54.181 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'DrugUsePreventionAPI.Controllers.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-24 15:07:54.793 +07:00 [ERR] Error updating consultant profile for UserID=23
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at DrugUsePreventionAPI.Repositories.UnitOfWork.SaveChangesAsync()
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantProfileAsync(Int32 userId, UpdateConsultantDto updateConsultantDto, Boolean isAdmin)
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateMyProfile(UpdateConsultantDto updateConsultantDto)
2025-07-24 15:08:00.692 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:08:00.767 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:08:00.832 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:08:00.842 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:08:00.854 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:08:00.867 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:08:03.063 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:08:03.123 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:08:20.627 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:08:21.711 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:08:21.846 +07:00 [ERR] An exception occurred in the database while saving changes for context type 'DrugUsePreventionAPI.Controllers.Data.ApplicationDbContext'.
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:23169768-6dcd-48b0-8224-4d28b0dcaf5b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:23169768-6dcd-48b0-8224-4d28b0dcaf5b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
2025-07-24 15:08:22.212 +07:00 [ERR] Error updating consultant profile for UserID=23
Microsoft.EntityFrameworkCore.DbUpdateException: An error occurred while saving the entity changes. See the inner exception for details.
 ---> Microsoft.Data.SqlClient.SqlException (0x80131904): Cannot insert the value NULL into column 'Password', table 'DrugUsePreventionDB_V4.dbo.Users'; column does not allow nulls. UPDATE fails.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlDataReader.TryHasMoreRows(Boolean& moreRows)
   at Microsoft.Data.SqlClient.SqlDataReader.TryReadInternal(Boolean setTimeout, Boolean& more)
   at Microsoft.Data.SqlClient.SqlDataReader.ReadAsyncExecute(Task task, Object state)
   at Microsoft.Data.SqlClient.SqlDataReader.InvokeAsyncCall[T](SqlDataReaderBaseAsyncCallContext`1 context)
--- End of stack trace from previous location ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeResultSetWithRowsAffectedOnlyAsync(Int32 commandIndex, RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
ClientConnectionId:23169768-6dcd-48b0-8224-4d28b0dcaf5b
Error Number:515,State:2,Class:16
   --- End of inner exception stack trace ---
   at Microsoft.EntityFrameworkCore.Update.AffectedCountModificationCommandBatch.ConsumeAsync(RelationalDataReader reader, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.ReaderModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Update.Internal.SqlServerModificationCommandBatch.ExecuteAsync(IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.Update.Internal.BatchExecutor.ExecuteAsync(IEnumerable`1 commandBatches, IRelationalConnection connection, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(IList`1 entriesToSave, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.SaveChangesAsync(StateManager stateManager, Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.SqlServer.Storage.Internal.SqlServerExecutionStrategy.ExecuteAsync[TState,TResult](TState state, Func`4 operation, Func`4 verifySucceeded, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at Microsoft.EntityFrameworkCore.DbContext.SaveChangesAsync(Boolean acceptAllChangesOnSuccess, CancellationToken cancellationToken)
   at DrugUsePreventionAPI.Repositories.UnitOfWork.SaveChangesAsync()
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantProfileAsync(Int32 userId, UpdateConsultantDto updateConsultantDto, Boolean isAdmin)
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateMyProfile(UpdateConsultantDto updateConsultantDto)
2025-07-24 15:09:48.503 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 15:09:48.545 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 15:09:48.558 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 15:09:48.571 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 15:21:45.580 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:21:51.852 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:21:51.919 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:21:52.076 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:21:52.101 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:21:52.121 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:21:52.155 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:21:55.054 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:21:55.079 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:22:13.734 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:22:14.114 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:22:14.281 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:22:14.313 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:22:14.365 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:22:14.396 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:22:14.425 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:22:14.586 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:24:48.612 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:24:49.549 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:24:52.340 +07:00 [ERR] Error updating consultant profile for UserID=23
System.InvalidOperationException: The instance of entity type 'Certificate' cannot be tracked because another instance with the same key value for {'CertificateID'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Repositories.GenericRepository`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantProfileAsync(Int32 userId, UpdateConsultantDto updateConsultantDto, Boolean isAdmin)
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateMyProfile(UpdateConsultantDto updateConsultantDto)
2025-07-24 15:26:55.391 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:26:55.763 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:26:56.316 +07:00 [ERR] Error updating consultant profile for UserID=23
System.InvalidOperationException: The instance of entity type 'Certificate' cannot be tracked because another instance with the same key value for {'CertificateID'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Repositories.GenericRepository`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantProfileAsync(Int32 userId, UpdateConsultantDto updateConsultantDto, Boolean isAdmin)
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateMyProfile(UpdateConsultantDto updateConsultantDto)
2025-07-24 15:27:35.445 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:32:56.238 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:32:56.967 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:32:57.295 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:32:57.358 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:32:57.424 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:32:57.466 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:32:59.060 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:32:59.090 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:33:24.569 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:33:24.672 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:33:25.114 +07:00 [ERR] Error updating consultant profile for UserID=23
System.InvalidOperationException: The instance of entity type 'Certificate' cannot be tracked because another instance with the same key value for {'CertificateID'} is already being tracked. When attaching existing entities, ensure that only one entity instance with a given key value is attached. Consider using 'DbContextOptionsBuilder.EnableSensitiveDataLogging' to see the conflicting key values.
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.ThrowIdentityConflict(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry, Boolean updateDuplicate)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(TKey key, InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.IdentityMap`1.Add(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.StateManager.StartTracking(InternalEntityEntry entry)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState oldState, EntityState newState, Boolean acceptChanges, Boolean modifyProperties)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.InternalEntityEntry.SetEntityState(EntityState entityState, Boolean acceptChanges, Boolean modifyProperties, Nullable`1 forceStateWhenUnknownKey, Nullable`1 fallbackState)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.PaintAction(EntityEntryGraphNode`1 node)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityEntryGraphIterator.TraverseGraph[TState](EntityEntryGraphNode`1 node, Func`2 handleNode)
   at Microsoft.EntityFrameworkCore.ChangeTracking.Internal.EntityGraphAttacher.AttachGraph(InternalEntityEntry rootEntry, EntityState targetState, EntityState storeGeneratedWithKeySetTargetState, Boolean forceStateWhenUnknownKey)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.SetEntityState(InternalEntityEntry entry, EntityState entityState)
   at Microsoft.EntityFrameworkCore.Internal.InternalDbSet`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Repositories.GenericRepository`1.Update(TEntity entity)
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.UpdateConsultantProfileAsync(Int32 userId, UpdateConsultantDto updateConsultantDto, Boolean isAdmin)
   at DrugUsePreventionAPI.Controllers.ConsultantController.UpdateMyProfile(UpdateConsultantDto updateConsultantDto)
2025-07-24 15:36:48.178 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:36:48.381 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:36:48.450 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:36:48.492 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:36:48.516 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:36:48.536 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:36:49.885 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:36:49.929 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:06.601 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:06.687 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:37:06.712 +07:00 [INF] Consultant updated Password for UserID=23
2025-07-24 15:37:07.147 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:22.032 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:22.046 +07:00 [INF] Updating consultant profile for UserID=23 by Consultant
2025-07-24 15:37:22.055 +07:00 [INF] Consultant updated Password for UserID=23
2025-07-24 15:37:22.243 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:28.368 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:28.380 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:37:28.392 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:37:28.397 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:28.411 +07:00 [INF] Retrieving appointments for consultant 8
2025-07-24 15:37:28.423 +07:00 [INF] Retrieved 8 appointments for consultant 8
2025-07-24 15:37:34.073 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:34.087 +07:00 [INF] JWT Token validated successfully for user: ConsultantKAKA, Roles: Consultant, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 23, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: ConsultantKAKA, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: consultantsgg@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Consultant, nbf: 1753344201, exp: 1753430601, iat: 1753344201, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:47.434 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:47.439 +07:00 [INF] Retrieving available consultants
2025-07-24 15:37:47.485 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:37:47.490 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:37:47.493 +07:00 [INF] Retrieving available consultants
2025-07-24 15:37:47.498 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:39:48.858 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 15:39:48.986 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:d3a99b3c-c273-43e0-bef2-6c2df7733d61
Error Number:8622,State:1,Class:16
2025-07-24 15:39:49.009 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:d3a99b3c-c273-43e0-bef2-6c2df7733d61
Error Number:8622,State:1,Class:16
2025-07-24 15:39:49.112 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:d3a99b3c-c273-43e0-bef2-6c2df7733d61
Error Number:8622,State:1,Class:16
2025-07-24 15:44:43.559 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:44:43.831 +07:00 [INF] Creating consultant with user HEHEKA
2025-07-24 15:44:44.287 +07:00 [INF] Created consultant 12 with user HEHEKA
2025-07-24 15:45:06.333 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:45:06.348 +07:00 [INF] Creating consultant with user HEHEKA
2025-07-24 15:45:06.356 +07:00 [WRN] Username HEHEKA already exists
2025-07-24 15:45:06.687 +07:00 [ERR] Unexpected error occurred while creating the consultant: User with Username 'HEHEKA' already exists.
DrugUsePreventionAPI.Exceptions.DuplicateEntityException: User with Username 'HEHEKA' already exists.
   at DrugUsePreventionAPI.Services.Implementations.ConsultantService.CreateConsultantAsync(CreateConsultantDto createConsultantDto)
   at DrugUsePreventionAPI.Controllers.ConsultantController.CreateConsultant(CreateConsultantDto createConsultantDto)
2025-07-24 15:52:16.950 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:17.149 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:17.507 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:52:17.551 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:17.556 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:17.579 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:52:45.702 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:45.839 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 15:52:45.861 +07:00 [INF] Retrieving all users
2025-07-24 15:52:45.949 +07:00 [INF] Retrieved 26 users
2025-07-24 15:52:46.139 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:46.145 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 15:52:46.148 +07:00 [INF] Retrieving all users
2025-07-24 15:52:46.170 +07:00 [INF] Retrieved 26 users
2025-07-24 15:52:46.317 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:46.398 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:46.613 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:52:46.630 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:46.637 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:46.689 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:52:56.288 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:56.292 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 15:52:56.295 +07:00 [INF] Retrieving all users
2025-07-24 15:52:56.306 +07:00 [INF] Retrieved 26 users
2025-07-24 15:52:56.310 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:56.318 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 15:52:56.321 +07:00 [INF] Retrieving all users
2025-07-24 15:52:56.327 +07:00 [INF] Retrieved 26 users
2025-07-24 15:52:57.546 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:57.549 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:57.567 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:52:57.570 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:52:57.574 +07:00 [INF] Retrieving available consultants
2025-07-24 15:52:57.580 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:53:04.560 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:53:04.564 +07:00 [INF] Retrieving available consultants
2025-07-24 15:53:04.571 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:53:04.574 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:53:04.579 +07:00 [INF] Retrieving available consultants
2025-07-24 15:53:04.584 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:54:23.351 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:54:23.489 +07:00 [INF] Creating consultant with user KAKAKA
2025-07-24 15:54:23.770 +07:00 [INF] Created consultant 13 with user KAKAKA
2025-07-24 15:54:34.499 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:54:48.628 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:55:03.524 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:55:03.540 +07:00 [INF] Admin updating consultant with ID 13
2025-07-24 15:55:10.658 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:55:10.663 +07:00 [INF] Admin updating consultant with ID 13
2025-07-24 15:55:17.570 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:55:17.575 +07:00 [INF] Admin updating consultant with ID 13
2025-07-24 15:55:43.289 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:55:43.301 +07:00 [INF] Admin updating consultant with ID 13
2025-07-24 15:56:07.955 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:56:07.963 +07:00 [INF] Retrieving available consultants
2025-07-24 15:56:07.998 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:56:08.015 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:56:08.018 +07:00 [INF] Retrieving available consultants
2025-07-24 15:56:08.024 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:58:03.362 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:58:03.371 +07:00 [INF] Retrieving available consultants
2025-07-24 15:58:03.390 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:58:03.395 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:58:03.399 +07:00 [INF] Retrieving available consultants
2025-07-24 15:58:03.418 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 15:58:52.608 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:58:52.638 +07:00 [INF] Creating consultant with user heheheheh
2025-07-24 15:58:52.989 +07:00 [INF] Created consultant 14 with user heheheheh
2025-07-24 15:59:16.866 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 15:59:16.890 +07:00 [INF] Admin updating consultant with ID 14
2025-07-24 16:04:04.531 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:04:04.683 +07:00 [INF] Retrieving available consultants
2025-07-24 16:04:04.984 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:04:36.216 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:04:36.231 +07:00 [INF] Retrieving available consultants
2025-07-24 16:04:36.269 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:04:36.278 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:04:36.287 +07:00 [INF] Retrieving available consultants
2025-07-24 16:04:36.306 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:05:30.714 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:05:30.732 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 16:05:30.736 +07:00 [INF] Retrieving all users
2025-07-24 16:05:30.844 +07:00 [INF] Retrieved 28 users
2025-07-24 16:05:30.850 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:05:30.859 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 16:05:30.861 +07:00 [INF] Retrieving all users
2025-07-24 16:05:30.867 +07:00 [INF] Retrieved 28 users
2025-07-24 16:05:31.192 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:05:31.195 +07:00 [INF] Retrieving available consultants
2025-07-24 16:05:31.211 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:05:31.214 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:05:31.218 +07:00 [INF] Retrieving available consultants
2025-07-24 16:05:31.223 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:06:51.470 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:06:51.536 +07:00 [INF] Creating consultant with user kakakakak
2025-07-24 16:06:51.768 +07:00 [INF] Created consultant 15 with user kakakakak
2025-07-24 16:07:19.938 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:07:19.948 +07:00 [INF] Admin updating consultant with ID 15
2025-07-24 16:09:49.224 +07:00 [ERR] Error occurred while cleaning up the 'Job' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 16:09:49.271 +07:00 [ERR] Error occurred while cleaning up the 'List' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 16:09:49.284 +07:00 [ERR] Error occurred while cleaning up the 'Set' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 16:09:49.304 +07:00 [ERR] Error occurred while cleaning up the 'Hash' table: Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
Microsoft.Data.SqlClient.SqlException (0x80131904): Query processor could not produce a query plan because of the hints defined in this query. Resubmit the query without specifying any hints and without using SET FORCEPLAN.
   at Microsoft.Data.SqlClient.SqlConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.SqlInternalConnection.OnError(SqlException exception, Boolean breakConnection, Action`1 wrapCloseInAction)
   at Microsoft.Data.SqlClient.TdsParser.ThrowExceptionAndWarning(TdsParserStateObject stateObj, Boolean callerHasConnectionLock, Boolean asyncClose)
   at Microsoft.Data.SqlClient.TdsParser.TryRun(RunBehavior runBehavior, SqlCommand cmdHandler, SqlDataReader dataStream, BulkCopySimpleResultSet bulkCopyHandler, TdsParserStateObject stateObj, Boolean& dataReady)
   at Microsoft.Data.SqlClient.SqlCommand.FinishExecuteReader(SqlDataReader ds, RunBehavior runBehavior, String resetOptionsString, Boolean isInternal, Boolean forDescribeParameterEncryption, Boolean shouldCacheForAlwaysEncrypted)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReaderTds(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, Boolean isAsync, Int32 timeout, Task& task, Boolean asyncWrite, Boolean inRetry, SqlDataReader ds, Boolean describeParameterEncryptionRequest)
   at Microsoft.Data.SqlClient.SqlCommand.RunExecuteReader(CommandBehavior cmdBehavior, RunBehavior runBehavior, Boolean returnStream, TaskCompletionSource`1 completion, Int32 timeout, Task& task, Boolean& usedCache, Boolean asyncWrite, Boolean inRetry, String method)
   at Microsoft.Data.SqlClient.SqlCommand.ExecuteNonQuery()
   at Hangfire.SqlServer.ExpirationManager.ExecuteNonQuery(DbConnection connection, String commandText, Int32 numberOfRecordsInSinglePass, Action`1 additionalActions, CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 240
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass11_0.<CleanupTable>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 124
   at Hangfire.SqlServer.ExpirationManager.<>c__DisplayClass12_0.<UseConnectionDistributedLock>b__0(DbConnection connection) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 146
   at Hangfire.SqlServer.SqlServerStorage.UseConnection[T](DbConnection dedicatedConnection, Func`2 func) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 257
   at Hangfire.SqlServer.SqlServerStorage.UseConnection(DbConnection dedicatedConnection, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\SqlServerStorage.cs:line 243
   at Hangfire.SqlServer.ExpirationManager.UseConnectionDistributedLock(SqlServerStorage storage, Action`1 action) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 140
   at Hangfire.SqlServer.ExpirationManager.CleanupTable(String query, String table, Int32 numberOfRecordsInSinglePass, CancellationToken cancellationToken, Action`1 additionalActions) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 118
   at Hangfire.SqlServer.ExpirationManager.Execute(CancellationToken cancellationToken) in C:\projects\hangfire-525\src\Hangfire.SqlServer\ExpirationManager.cs:line 77
ClientConnectionId:516104a4-7a73-430b-a908-1de1fa00acaa
Error Number:8622,State:1,Class:16
2025-07-24 16:15:00.896 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:00.948 +07:00 [INF] Retrieving available consultants
2025-07-24 16:15:01.061 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:15:01.072 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:01.076 +07:00 [INF] Retrieving available consultants
2025-07-24 16:15:01.082 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:15:06.760 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:06.799 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 16:15:06.805 +07:00 [INF] Retrieving all users
2025-07-24 16:15:06.838 +07:00 [INF] Retrieved 29 users
2025-07-24 16:15:06.843 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:06.847 +07:00 [INF] User: Manager, IsAuthenticated: true, Roles: ["http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager"]
2025-07-24 16:15:06.850 +07:00 [INF] Retrieving all users
2025-07-24 16:15:06.856 +07:00 [INF] Retrieved 29 users
2025-07-24 16:15:07.138 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:07.142 +07:00 [INF] Retrieving available consultants
2025-07-24 16:15:07.162 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:15:07.167 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:15:07.172 +07:00 [INF] Retrieving available consultants
2025-07-24 16:15:07.179 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:23:25.578 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:23:25.741 +07:00 [INF] Retrieving available consultants
2025-07-24 16:23:26.277 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:23:26.304 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:23:26.313 +07:00 [INF] Retrieving available consultants
2025-07-24 16:23:26.346 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:23:30.165 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:23:30.175 +07:00 [INF] Retrieving available consultants
2025-07-24 16:23:30.205 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:23:30.213 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:23:30.221 +07:00 [INF] Retrieving available consultants
2025-07-24 16:23:30.230 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:24:56.246 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:24:56.482 +07:00 [INF] Creating consultant with user HEHEEHEHEH
2025-07-24 16:24:56.879 +07:00 [INF] Created consultant 16 with user HEHEEHEHEH
2025-07-24 16:25:03.639 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:25:03.645 +07:00 [INF] Retrieving available consultants
2025-07-24 16:25:03.696 +07:00 [INF] Retrieved 7 available consultants
2025-07-24 16:25:03.700 +07:00 [INF] JWT Token validated successfully for user: Manager, Roles: Manager, Claims: http://schemas.xmlsoap.org/ws/2005/05/identity/claims/nameidentifier: 22, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/name: Manager, http://schemas.xmlsoap.org/ws/2005/05/identity/claims/emailaddress: manager@gmail.com, http://schemas.microsoft.com/ws/2008/06/identity/claims/role: Manager, nbf: 1753346263, exp: 1753432663, iat: 1753346263, iss: DrugUsePreventionAPI, aud: DrugUsePreventionClient
2025-07-24 16:25:03.703 +07:00 [INF] Retrieving available consultants
2025-07-24 16:25:03.709 +07:00 [INF] Retrieved 7 available consultants
